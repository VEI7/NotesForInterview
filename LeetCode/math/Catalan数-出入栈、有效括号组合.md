# 卡特兰数

对卡特兰数的初步理解：有一些操作，这些操作有着一定的限制，如一种操作数不能超过另外一种操作数，或者两种操作不能有交集等，这些操作的合法操作顺序的数量

## 定义

**递归定义**

$𝑓_𝑛=𝑓_0∗𝑓_{𝑛−1}+𝑓_1∗𝑓_{𝑛−2}+…+𝑓_{𝑛−1}𝑓_0$，其中𝑛≥2

**递推关系**

$𝑓_𝑛=(4𝑛−2/𝑛+1)𝑓_{𝑛−1}$

**通项公式**

$𝑓𝑛=C_{2n}^n/(n+1)$

经化简后可得

$𝑓𝑛=C_{2n}^n - C_{2n}^{n-1}$

从零开始，卡特兰数的前几项为1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900,2674440,9694845,35357670,129644790… 

# 实际问题

## 进出栈问题

有一个栈，我们有2𝑛次操作，n次进栈，n次出栈，问有多少中合法的进出栈序列

合法的序列个数为$C_{2n}^n - C_{2n}^{n-1}$

要使序列合法，在任何一个前缀中进栈次数都不能少于出栈次数…

显然有c(2n, n)个含S，X各n个的序列，剩下的是计算不允许的序列数(它包含正确个数的S和X，但是违背其它条件)。 在任何不允许的序列中，定出使得X的个数超过S的个数的第一个X的位置。然后在导致并包括这个X的部分序列中，以S代替所有的X并以X代表所有的S。结果是一个有(n+1)个S和(n-1)个X的序列。反过来，对一种类型的每个序列，我们都能逆转这个过程，而且找出导致它的前一种类型的不允许序列。例如XXSXSSSXXSSS必然来自SSXSXXXXXSSS。这个对应说明，不允许的序列的个数是c(2n, n-1)，因此an = c(2n, n) - c(2n, n-1)。

## 01序列

你现在有n个0和n个1，问有多少个长度为2n的序列，使得序列的任意一个前缀中1的个数都大于等于0的个数
例如𝑛=2时
有1100,1010两种合法序列
而1001,0101,0110,0011都是不合法的序列

合法的序列个数为$C_{2n}^n - C_{2n}^{n-1}$

## 括号匹配

你有n个左括号，n个右括号，问有多少个长度为2n的括号序列使得所有的括号都是合法的

## 不相交弦问题

在一个圆周上分布着 2n个点，两两配对，并在这两个点之间连一条弦，要求所得的2n条弦彼此不相交的配对方案数

## 排队问题

12个高矮不同的人，排成两排，每排必须是从矮到高排列，而且第二排比对应的第一排的人高，问排列方式有多少种？

用0表示对应的人在第一排,用1表示对应的人在第二排,那么含有6个0,6个1的序列,就对应一种方案.

观察1的出现，我们考虑这一个出现能不能放在第二排，显然，在这个1之前出现的那些0,1对应的人 要么是在这个1左边，要么是在这个1前面。而肯定要有一个0的，在这个1前面，统计在这个1之前的0和1的个数。 也就是要求，0的个数大于1的个数。

## 二叉树的构成问题

有n个点，问用这n个点最终能构成多少二叉树

答案仍然是卡特兰数列

这个问题不是用上面的方法，是用递归定义的卡特兰数

一个二叉树分为根节点，左子树，右子树
其中左子树和右子树也是二叉树，左右子树节点个数加起来等于n−1
设i个点能构成fi个二叉树
我们枚举左子树有几个点可得
𝑓𝑛=𝑓0∗𝑓𝑛−1+𝑓1∗𝑓𝑛−2+…+𝑓𝑛−1∗𝑓0
这个和卡特兰数列的递归定义是一模一样的

## 凸多边形的三角划分

一个凸的𝑛n边形，用直线连接他的两个顶点使之分成多个三角形，每条直线不能相交，问一共有多少种划分方案

答案还是卡特兰数列

我们在凸多边形中随便挑两个顶点连一条边，这个凸多边形就会被分成两个小凸多边形，由于每条直线不能相交，接下来我们就只要求这两个小凸多边形的划分方案然后乘起来即可

和二叉树的构成问题一样，我们枚举大凸多边形被分成的两个小凸多边形的大小即可